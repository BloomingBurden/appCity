(()=>{"use strict";!function(e){let t=new Image;t.onload=t.onerror=function(){!function(e){let t=e?"webp":"no-webp";document.documentElement.classList.add(t)}(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}();const e=(e,t)=>{e.wrap.innerHTML="",e.input.value=t.currentTarget.textContent,e.input.setAttribute("value",t.currentTarget.textContent)},t=document.querySelector(".orders__list"),r=document.querySelector(".road__list");let o=localStorage.length,a=localStorage.length-3,n=localStorage.length-3;const s=()=>{const e=document.querySelector(".orders__more"),o=document.querySelector(".road__show"),s=e=>{if("order"===e)for(let e=0;e<Math.min(3,n);e++)t.innerHTML+=JSON.parse(localStorage.getItem(n-1)).order,n--;if("road"===e)for(let e=0;e<Math.min(3,a);e++)r.innerHTML+=JSON.parse(localStorage.getItem(a-1)).roadItem,a--};e.addEventListener("click",s.bind(null,"order")),o.addEventListener("click",s.bind(null,"road"))},l=()=>{const e=document.querySelector(".orders__list"),t=document.querySelector(".road__list"),r=Object.keys(localStorage);e.innerHTML="",t.innerHTML="",r.forEach(((r,o)=>{o<3&&(e.innerHTML+=JSON.parse(localStorage.getItem(r)).order,t.innerHTML+=JSON.parse(localStorage.getItem(r)).roadItem)})),s()},c=document.querySelector(".form-order__addr input"),d=document.querySelector(".cites"),i={item:null,input:c,wrap:d};let m=((e,t=300)=>{let r;return(...o)=>{clearTimeout(r),r=setTimeout((()=>{e.apply(void 0,o)}),t)}})((t=>{c.value.length<1||fetch(`https://api.geoapify.com/v1/geocode/autocomplete?text=${c.value}&format=json&apiKey=8e01b239842444148b628ba779696433`,{method:"GET"}).then((e=>e.json())).then((t=>{const r=document.createDocumentFragment();t.results.forEach((t=>{const o=document.createElement("li");o.classList.add("city"),o.textContent=t.formatted,r.append(o),i.item=t,o.addEventListener("click",e.bind(null,i))})),d.innerHTML="",d.append(r)})).catch((e=>console.log("error",e)))}),300);c.addEventListener("input",m),document.addEventListener("click",(e=>{d.innerHTML=""})),(e=>{const s=document.querySelector(".form-order");s.addEventListener("submit",(c=>{c.preventDefault(),e.item?(l(),((e,s)=>{let l=`<li class="orders__item">\n                        <div class="orders__data">\n                            <h3 class="orders__preview">Адрес доставки</h3>\n                            <p class="orders__descr">${s.address.value}</p>\n                        </div>\n                        <div class="orders__data">\n                            <h3 class="orders__preview">Координаты</h3>\n                            <p class="orders__descr orders__descr--cord"><span>${e.lat}</span><span>${e.lon}</span></p>\n                        </div>\n                        <div class="orders__data">\n                            <h3 class="orders__preview">Расстояние</h3>\n                            <p class="orders__descr">2367.01 км</p>\n                        </div>\n                        <button class="remove-item">Удалить</button>\n                    </li>`,c=`<li class="road__item">\n                        <h3 class="road__preview">Маршрут 1</h3>\n                        <p class="road__text road__text-from">От адреса:  ДУ,Бургундия - Франш-конте,метрополия Франции,Франция</p>\n                        <p class="road__text road__text-to">До адреса: ${s.address.value}</p>\n                        <p class="road__text road__text-time">Время: <span>2367 мин</span></p>\n                        <p class="road__text road__text-volume">Объем аккумулятора: 8.58 %</p>\n                        <p class="road__text road__text-weight">Вес груза: ${s.weight.value}г</p>\n                        <button class="remove-item">Удалить</button>\n                    </li>`;const d=JSON.stringify({order:l,roadItem:c});localStorage.setItem(`${o}`,d),a++,n++,o++,o<=3&&(t.innerHTML+=JSON.parse(localStorage.getItem(o-1)).order,r.innerHTML+=JSON.parse(localStorage.getItem(o-1)).roadItem)})(e.item,s),e.item=null,e.input.value="",(()=>{const e=document.querySelectorAll(".footer__item"),t=document.querySelectorAll("[data-id-menu]");e.forEach(((e,t)=>{e.classList.remove("footer__item--current"),1===t&&e.classList.add("footer__item--current")})),t.forEach((e=>{e.classList.remove("layer--active"),2==+e.dataset.idMenu&&e.classList.add("layer--active")}))})()):(e.input.value="Пожалуйста, введите город из списка.",e.input.style.color="red",setTimeout((()=>{e.input.removeAttribute("style")}),3e3))}))})(i),window.addEventListener("load",(()=>{(()=>{const e=document.querySelectorAll(".footer__link"),t=document.querySelectorAll(".footer__item"),r=document.querySelectorAll("[data-id-menu]");e.forEach(((e,o)=>e.addEventListener("click",(a=>{a.preventDefault(),t.forEach((e=>e.classList.remove("footer__item--current"))),e.closest(".footer__item").classList.add("footer__item--current"),r.forEach((e=>{e.classList.remove("layer--active"),+e.dataset.idMenu===o+1&&e.classList.add("layer--active")}))}))))})(),((e=55.751574,t=37.573856)=>{ymaps.ready((function(){var r=new ymaps.Map("map",{center:[e,t],zoom:8,controls:[]}),o=new ymaps.Placemark(r.getCenter(),{hintContent:"Собственный значок метки",balloonContent:"Это красивая метка"},{iconLayout:"default#image",iconImageHref:"../img/map/icon_map.png",iconImageSize:[41,41]});r.geoObjects.add(o)}))})(),l()}))})();